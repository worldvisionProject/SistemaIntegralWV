@inject Microsoft.AspNetCore.Mvc.Localization.IViewLocalizer localizer
@using WordVision.ec.Web.Areas.Soporte.Models
@model SolicitudViewModel

<script type="text/javascript">
    $(document).ready(function () {
        var rating = $("#lblRating").val();
        for (var i = 1; i <= rating; i++) {
            $("#span" + i).attr('class', 'fa fa-star fa-2x color-estrella')
        }
    }
    );
    function CRateOut(rating) {
        for (var i = 1; i <= rating; i++) {
            $("#span" + i).attr('class','fa fa-star-o fa-2x')
        }
    }

    function CRateOver(rating) {
        for (var i = 1; i <= rating; i++) {
            $("#span" + i).attr('class', 'fa fa-star fa-2x color-estrella')
        }
    }

    function CRateClick(rating) {
       $("#lblRating").val(rating);
        //document.getElementById("lblRating").value = rating;
        for (var i = 1; i <= rating; i++) {
            $("#span" + i).attr('class', 'fa fa-star fa-2x color-estrella')
        }

        for (var i = rating+1; i <= 5; i++) {
            $("#span" + i).attr('class', 'fa fa-star-o fa-2x')
        }
    }

    function CRateSelected() {
        var rating = $("#lblRating").val();
        for (var i = 1; i <= rating; i++) {
            $("#span" + i).attr('class', 'fa fa-star fa-2x color-estrella')
        }
    }
    function VerifyRating() {
        var rating =  $("#lblRating").val();
        if (rating=="0") {
            alert("Por favor seleccione enl Rating");
            return false;
        }
    }
</script>

<form id="create-form" method="post" asp-controller="Comunicacion" asp-action="OnPostCreateOrEdit" asp-route-id="@Model.Id" onsubmit="return jQueryModalPost(this);" enctype="multipart/form-data">

    <div class="row">
        <div class="col-md-12">
            <div class="form-group row">
                        <div class="col-md-12">
                            <label class="col-md-12  texto-pregunta-bold">

                                NOTA: 
Los productos que el área de Comunicaciones entrega son: </label>
<label class="col-md-12  texto-pregunta-bold">- Invitación general con datos del evento&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- Piezas gráficas con perfiles de cada ponente
</label>
<label class="col-md-12  texto-pregunta-bold">- Video en loop de bienvenida para inicio del evento&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- Video en loop de cierre/agradecimiento para final del evento
</label>
<label class="col-md-12 ">- Láminas con perfil de cada ponente para su presentación durante el evento
                            </label>
                          
                        </div>
                    </div>

            <input type="hidden" asp-for="Op" name="Op" class="form-control">
            <input type="hidden" asp-for="IdColaborador" name="IdColaborador" value="@Convert.ToInt32(User.Claims.FirstOrDefault(x => x.Type == "Id")?.Value)" class="form-control">
            @if (Model.Op == 2)
            {
                if (Model.Estado != 1)
                {
                    <div class="form-group row">
                        <div class="col-md-6">
                            <label class="col-md-12 col-form-label texto-pregunta">Asignado a</label>
                            @Html.DropDownListFor(x => x.IdAsignadoA, (IEnumerable<SelectListItem>)Model.AsignadoAList, new { @class = "form-control", @disabled = "disabled" })

                            <span asp-validation-for="IdAsignadoA" class="text-danger"></span>
                        </div>
                    </div>

                }
                else
                {
                    <div class="form-group row">
                        <div class="col-md-6">
                            <label class="col-md-12 col-form-label texto-pregunta">Asignar a</label>
                            @Html.DropDownListFor(x => x.IdAsignadoA, (IEnumerable<SelectListItem>)Model.AsignadoAList, new { @class = "form-control" })

                            <span asp-validation-for="IdAsignadoA" class="text-danger"></span>
                        </div>
                    </div>
                }


            }
            else
       if (Model.Estado != 1)
            {
                <div class="form-group row">
                    <div class="col-md-6">
                        <label class="col-md-12 col-form-label texto-pregunta">Asignado a</label>
                        @Html.DropDownListFor(x => x.IdAsignadoA, (IEnumerable<SelectListItem>)Model.AsignadoAList, new { @class = "form-control", @disabled = "disabled" })

                        <span asp-validation-for="IdAsignadoA" class="text-danger"></span>
                    </div>
                </div>

            }

            <br />
            <div class="form-group row">
                <div class="col-md-2">
                    <label class="col-md-12 col-form-label texto-pregunta">No. Solicitud</label>
                    <input asp-for="Id" name="Id" class="form-control" readonly />
                </div>
                <div class="col-md-4">
                    <label class="col-md-12 col-form-label texto-pregunta">Tipo de requerimiento</label>
                    @if (Model.Estado == 1 && Model.Op == 1)
                    {
                        @Html.DropDownListFor(x => x.Comunicaciones.TipoSolicitud, (IEnumerable<SelectListItem>)Model.TiposTramitesList, new { @class = "form-control" })
                    }
                    else
                    {
                        @Html.DropDownListFor(x => x.Comunicaciones.TipoSolicitud, (IEnumerable<SelectListItem>)Model.TiposTramitesList, new { @class = "form-control", @disabled = "disabled" })
                    }
                    <span asp-validation-for="Comunicaciones.TipoSolicitud" class="text-danger"></span>
                </div>
                <div class="col-md-4">
                    <label class="col-md-12 col-form-label texto-pregunta" asp-for="CreatedOn"></label>
                    <input type="text" asp-for="CreatedOn" name="CreatedOn" class="datepicker form-control" disabled />
                    <span asp-validation-for="CreatedOn" class="text-danger"></span>
                </div>
                <div class="col-md-2">
                    <label class="col-md-12 col-form-label texto-pregunta" asp-for="Estado"></label>
                    @Html.DropDownListFor(x => x.Estado, (IEnumerable<SelectListItem>)Model.EstadoList, new { @class = "form-control", @disabled = "disabled" })

                    <span asp-validation-for="Estado" class="text-danger"></span>
                </div>
            </div>
             <hr />
            <div class="form-group row">

                <div class="col-md-4">
                    <label class="col-md-12 col-form-label texto-pregunta" asp-for="Comunicaciones.Presupuesto"></label>
                    @if (Model.Estado == 1 && Model.Op == 1)
                    {
                        <input type="text" asp-for="Comunicaciones.Presupuesto" name="Comunicaciones.Presupuesto" class="form-control">
                    }
                    else
                    {
                        <input type="text" asp-for="Comunicaciones.Presupuesto" name="Comunicaciones.Presupuesto" class="form-control" readonly>
                    }
                    <span asp-validation-for="Comunicaciones.Presupuesto" class="text-danger"></span>
                </div>

                <div class="col-md-4">
                    <label class="col-md-12 col-form-label texto-pregunta" asp-for="Comunicaciones.DisponibilidadPresupuestaria"></label>
                    <div class="custom-file form-image">
                        @if (Model.Comunicaciones != null)
                        {
                            if (Model.Comunicaciones.DisponibilidadPresupuestaria != null && Model.Comunicaciones.DisponibilidadPresupuestaria.Length > 0)
                            {
                                <a href='/soporte/Comunicacion/ShowPDF?idSolicitud=@Model.Id&tipo=1' target="_blank"><i class="fas fa-newspaper"></i> Ver Adjunto</a>
                            }
                          
                        }
                        else

                        {
                            <input accept=".pdf"
                                   asp-for="@Model.Comunicaciones.DisponibilidadPresupuestaria"
                                   type="file" class="custom-file-input"
                                   id="customFile">

                                  

                            if (Model.Comunicaciones != null)
                            {
                                if (Model.Comunicaciones.DisponibilidadPresupuestaria != null && Model.Comunicaciones.DisponibilidadPresupuestaria.Length > 0)
                                {
                                    <label class="custom-file-label" for="customFile">Archivo almacenado</label>
                                }
                                else
                                {
                                    <label class="custom-file-label" for="customFile">Buscar Archivo</label>
                                }
                            }
                            else
                            {
                                <label class="custom-file-label" for="customFile">Buscar Archivo1</label>
                            }
                        }

                    </div>
                </div>

                <div class="col-md-4">
                    <label class="col-md-12 col-form-label texto-pregunta" asp-for="Comunicaciones.AutorizaciondelLider"></label>
                    <div class="custom-file form-image">
                        @if (Model.Comunicaciones != null)
                        {
                            if (Model.Comunicaciones.AutorizaciondelLider != null && Model.Comunicaciones.AutorizaciondelLider.Length > 0)
                            {
                                <a href='/soporte/Comunicacion/ShowPDF?idSolicitud=@Model.Id&tipo=2' target="_blank"><i class="fas fa-newspaper"></i> Ver Adjunto</a>
                            }
                        }
                        else

                        {
                            <input accept=".pdf"
                                   asp-for="@Model.Comunicaciones.AutorizaciondelLider"
                                   type="file" class="custom-file-input"
                                   id="customFile">

                            if (Model.Comunicaciones != null)
                            {
                                if (Model.Comunicaciones.AutorizaciondelLider != null && Model.Comunicaciones.AutorizaciondelLider.Length > 0)
                                {
                                    <label class="custom-file-label" for="customFile">Archivo almacenado</label>
                                }
                                else
                                {
                                    <label class="custom-file-label" for="customFile">Buscar Archivo</label>
                                }
                            }
                            else
                            {
                                <label class="custom-file-label" for="customFile">Buscar Archivo</label>
                            }
                        }

                    </div>
                </div>
            </div>
        
            <hr />
            <div class="form-group row">
                <div class="col-md-6">
                    <label class="col-md-12 col-form-label texto-pregunta" asp-for="Comunicaciones.NombreEvento"></label>
                    @if (Model.Estado == 1 && Model.Op == 1)
                    {

                        <input type="text" asp-for="Comunicaciones.NombreEvento" name="Comunicaciones.NombreEvento" class="form-control" />
                    }
                    else
                    {
                        <input type="text" asp-for="Comunicaciones.NombreEvento" name="Comunicaciones.NombreEvento" class="form-control" readonly />
                    }
                    <span asp-validation-for="Comunicaciones.NombreEvento" class="text-danger"></span>
                </div>
                <div class="col-md-3">
                    <label class="col-md-12 col-form-label texto-pregunta" asp-for="Comunicaciones.FechaEvento"></label>
                    @if (Model.Estado == 1 && Model.Op == 1)
                    {
                        <input type="text" asp-for="Comunicaciones.FechaEvento" name="Comunicaciones.FechaEvento" class="datepicker form-control" />
                    }
                    else
                    {
                        <input type="text" asp-for="Comunicaciones.FechaEvento" name="Comunicaciones.FechaEvento" class="datepicker form-control" disabled />
                    }
                    <span asp-validation-for="Comunicaciones.FechaEvento" class="text-danger"></span>
                </div>
                <div class="col-md-3">
                    <label class="col-md-12 col-form-label texto-pregunta" asp-for="Comunicaciones.HoraEvento"></label>
                    @if (Model.Estado == 1 && Model.Op == 1)
                    {
                        <input type="time" asp-for="Comunicaciones.HoraEvento" name="Comunicaciones.HoraEvento" class="form-control" />
                    }
                    else
                    {
                        <input type="time" asp-for="Comunicaciones.HoraEvento" name="Comunicaciones.HoraEvento" class="form-control" disabled />
                    }
                    <span asp-validation-for="Comunicaciones.HoraEvento" class="text-danger"></span>
                </div>

                
            </div>

             <div class="form-group row" id="presencial">
             <div class="col-md-6" >
                    <label class="col-md-12 col-form-label texto-pregunta" asp-for="Comunicaciones.LugarEvento"></label>
                    @if (Model.Estado == 1 && Model.Op == 1)
                    {
                        <input type="text" asp-for="Comunicaciones.LugarEvento" name="Comunicaciones.LugarEvento" class="form-control" />
                    }
                    else
                    {
                        <input type="text" asp-for="Comunicaciones.LugarEvento" name="Comunicaciones.LugarEvento" class="form-control" disabled />
                    }
                    <span asp-validation-for="Comunicaciones.LugarEvento" class="text-danger"></span>
                </div>
                 <div class="col-md-3">
                    <label class="col-md-12 col-form-label texto-pregunta" asp-for="Comunicaciones.NumeroParticipantesP"></label>
                    @if (Model.Estado == 1 && Model.Op == 1)
                    {
                        <input type="number" asp-for="Comunicaciones.NumeroParticipantesP" name="Comunicaciones.NumeroParticipantesP" class="form-control">
                    }
                    else
                    {
                        <input type="number" asp-for="Comunicaciones.NumeroParticipantesP" name="Comunicaciones.NumeroParticipantesP" class="form-control" readonly>
                    }
                    <span asp-validation-for="Comunicaciones.NumeroParticipantesP" class="text-danger"></span>
                </div>
            </div>
          
            <div class="form-group row">
                <div class="col-md-6">
                    <label class="col-md-12 col-form-label texto-pregunta" asp-for="Comunicaciones.ObjetivoEvento"></label>
                    @if (Model.Estado == 1 && Model.Op == 1)
                    {
                        <textarea asp-for="Comunicaciones.ObjetivoEvento" name="Comunicaciones.ObjetivoEvento" class="form-control"></textarea>
                    }
                    else
                    {
                        <textarea asp-for="Comunicaciones.ObjetivoEvento" name="Comunicaciones.ObjetivoEvento" class="form-control" readonly></textarea>
                    }
                    <span asp-validation-for="Comunicaciones.ObjetivoEvento" class="text-danger"></span>
                </div>
                <div class="col-md-6">
                    <label class="col-md-12 col-form-label texto-pregunta" asp-for="Comunicaciones.PublicoObjetivo"></label>
                    @if (Model.Estado == 1 && Model.Op == 1)
                    {
                        <textarea asp-for="Comunicaciones.PublicoObjetivo" name="Comunicaciones.PublicoObjetivo" class="form-control"></textarea>
                    }
                    else
                    {
                        <textarea asp-for="Comunicaciones.PublicoObjetivo" name="Comunicaciones.PublicoObjetivo" class="form-control" readonly></textarea>
                    }
                    <span asp-validation-for="Comunicaciones.PublicoObjetivo" class="text-danger"></span>
                </div>
            </div>

            <div class="form-group row" id="virtual">
                <div class="col-md-6">
                    <label class="col-md-12 col-form-label texto-pregunta" asp-for="Comunicaciones.NumeroParticipantes"></label>
                    @if (Model.Estado == 1 && Model.Op == 1)
                    {
                        <input type="number" asp-for="Comunicaciones.NumeroParticipantes" name="Comunicaciones.NumeroParticipantes" class="form-control">
                    }
                    else
                    {
                        <input type="number" asp-for="Comunicaciones.NumeroParticipantes" name="Comunicaciones.NumeroParticipantes" class="form-control" readonly>
                    }
                    <span asp-validation-for="Comunicaciones.NumeroParticipantes" class="text-danger"></span>
                </div>

                <div class="col-md-2">

                    <label class="col-md-12 col-form-label texto-pregunta" asp-for="Comunicaciones.TransmisionVirtual"></label>
                    @if (Model.Estado == 1 && Model.Op == 1)
                    {
                         <select 
                                asp-for="Comunicaciones.TransmisionVirtual" name="Comunicaciones.TransmisionVirtual" >

                                <option value='1'>SI</option>
                                <option value='0'>NO</option>
                            </select>
                        @*<input type="checkbox" asp-for="Comunicaciones.TransmisionVirtual" name="Comunicaciones.TransmisionVirtual" class="form-control">*@
                    }
                    else
                    {
                        @*<input type="checkbox" asp-for="Comunicaciones.TransmisionVirtual" name="Comunicaciones.TransmisionVirtual" class="form-control" disabled>*@
                            <select 
                                asp-for="Comunicaciones.TransmisionVirtual" name="Comunicaciones.TransmisionVirtual" disabled>

                                <option value='1'>SI</option>
                                <option value='0'>NO</option>
                            </select>
                    }
                    <span asp-validation-for="Comunicaciones.TransmisionVirtual" class="text-danger"></span>
                </div>

               
            </div>
            <div class="form-group row" id="presencialP">
               
                    <div class="col-md-4" >
                    <label class="col-md-12 col-form-label texto-pregunta" asp-for="Comunicaciones.SituacionesInteresWV"></label>
                    @if (Model.Estado == 1 && Model.Op == 1)
                    {
                        <textarea asp-for="Comunicaciones.SituacionesInteresWV" name="Comunicaciones.SituacionesInteresWV" class="form-control" ></textarea>
                    }
                    else
                    {
                        <textarea  asp-for="Comunicaciones.SituacionesInteresWV" name="Comunicaciones.SituacionesInteresWV" class="form-control" readonly ></textarea>
                    }
                    <span asp-validation-for="Comunicaciones.SituacionesInteresWV" class="text-danger"></span>
                    </div>

                    <div class="col-md-4" >
                    <label class="col-md-12 col-form-label texto-pregunta" asp-for="Comunicaciones.PersonasAsistiran"></label>
                    @if (Model.Estado == 1 && Model.Op == 1)
                    {
                        <textarea asp-for="Comunicaciones.PersonasAsistiran" name="Comunicaciones.PersonasAsistiran" class="form-control" ></textarea>
                    }
                    else
                    {
                        <textarea  asp-for="Comunicaciones.PersonasAsistiran" name="Comunicaciones.PersonasAsistiran" class="form-control" readonly ></textarea>
                    }
                    <span asp-validation-for="Comunicaciones.PersonasAsistiran" class="text-danger"></span>
                    </div>
                    <div class="col-md-4" >
                        <label class="col-md-12 col-form-label texto-pregunta" asp-for="Comunicaciones.PersonalWV"></label>
                        @if (Model.Estado == 1 && Model.Op == 1)
                        {
                            <textarea  asp-for="Comunicaciones.PersonalWV" name="Comunicaciones.PersonalWV" class="form-control" ></textarea>
                        }
                        else
                        {
                            <textarea asp-for="Comunicaciones.PersonalWV" name="Comunicaciones.PersonalWV" class="form-control" readonly ></textarea>
                        }
                        <span asp-validation-for="Comunicaciones.PersonalWV" class="text-danger"></span>
                    </div>
                    <div class="col-md-4" >
                        <label class="col-md-12 col-form-label texto-pregunta" asp-for="Comunicaciones.SociosInteractuar"></label>
                        @if (Model.Estado == 1 && Model.Op == 1)
                        {
                            <textarea asp-for="Comunicaciones.SociosInteractuar" name="Comunicaciones.SociosInteractuar" class="form-control" ></textarea>
                        }
                        else
                        {
                            <textarea asp-for="Comunicaciones.SociosInteractuar" name="Comunicaciones.SociosInteractuar" class="form-control" readonly ></textarea>
                        }
                        <span asp-validation-for="Comunicaciones.SociosInteractuar" class="text-danger"></span>
                    </div>
               
            </div>

             <div class="form-group row">
              
                     <div class="col-md-6">
                    <label class="col-md-12 col-form-label texto-pregunta" asp-for="Comunicaciones.GuionEvento"></label>
                    <div class="custom-file form-image">
                        @if (Model.Comunicaciones != null)
                        {
                            if (Model.Comunicaciones.GuionEvento != null && Model.Comunicaciones.GuionEvento.Length > 0)
                            {
                                <a href='/soporte/Comunicacion/ShowPDF?idSolicitud=@Model.Id&tipo=3' target="_blank"><i class="fas fa-newspaper"></i> Ver Adjunto</a>
                            }
                        }
                        else

                        {
                            <input accept=".pdf"
                                   asp-for="@Model.Comunicaciones.GuionEvento"
                                   type="file" class="custom-file-input"
                                   id="customFile">

                            if (Model.Comunicaciones != null)
                            {
                                if (Model.Comunicaciones.GuionEvento != null && Model.Comunicaciones.GuionEvento.Length > 0)
                                {
                                    <label class="custom-file-label" for="customFile">Archivo almacenado</label>
                                }
                                else
                                {
                                    <label class="custom-file-label" for="customFile">Buscar Archivo</label>
                                }
                            }
                            else
                            {
                                <label class="custom-file-label" for="customFile">Buscar Archivo</label>
                            }
                        }

                    </div>
                </div>
              
            </div>


            <div class="form-group row" id="divPonente">
              
               <div class="col-md-7">
                <button type="button" class="btn btn-primary" id="btnAddPonente" data-toggle="modal" data-target="#form-add">
                    <i class="fas fa-plus-square"></i>
                    Ponentes
                </button>
                
               <table id="ponenteTable" class="table table-striped" width="100%" cellspacing="0">
                    <thead>
                        <tr>
                
                            <th>Ponente</th>
                            <th>Cargo</th>
                            <th>Perfíl</th>
                            <th>Tema</th>

                            <th class="acciones-th">Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (Model.Comunicaciones != null)
                        {

                            @foreach (var ponentes in Model.Comunicaciones.Ponentes.ToList())
                            {
                        <tr id="Ponente_@ponentes.Id">
                            <td>
                                @ponentes.NombreApellido
                            </td>
                            <td>
                                @ponentes.Cargo
                            </td>
                            <td>
                                @ponentes.Perfil
                            </td>
                            <td>
                                 @ponentes.Tema
                            </td>

                            <td class="acciones-td">
                                 <button type="button" class="btn btn-warning btn-xp" id="btnViewModel" onclick="ActualizaFila(@ponentes.Id,@ponentes.NombreApellido,@ponentes.Cargo,@ponentes.Perfil,@ponentes.Tema)" data-toggle="modal" data-target="#form-add">
                                   <i class="fas fa-pencil-alt"></i>
                                 </button>
                                <button type="button" onclick="EliminaFila(@ponentes.Id)" class="btn btn-danger btn-xp">
                                    <i class="fas fa-trash-alt"></i> 
                                </button>
                            </td>

                        </tr>
                            }}

                             <input type="hidden" id="idact" name="idact" />
                    </tbody>
               </table>
      
               </div>
             </div>
               <div class="form-group row" id="divLogo">
                  <div class="col-md-5">
                       <div class="form-group row" >
                           <div class="col-md-12">
                                <button type = "button" class="btn btn-primary"  onclick = "addFile ()" >
                                    <i class="fas fa-plus-square"></i>
                                    Logos Socios Involucrados
                                </button>
                            </div>
                       </div>
                        <div class="form-group row">
                       
                         <div class="col-md-12" id="_container">
                            <input type="file"  name="File" class="custom-file-input" />
                          </div>
                       </div>
                  </div>
            </div>


            @if (Model.Estado == 2 || Model.Estado == 3 || Model.Estado == 4 || Model.Estado == 5)
            {
                <div class="form-group row">
                    @*<div class="col-md-6">
                    <label class="col-md-12 col-form-label texto-pregunta">Observación Asignación</label>
                    <textarea asp-for="ObservacionesSolucion" name="ObservacionesSolucion" class="form-control"></textarea>
                    <span asp-validation-for="ObservacionesSolucion" class="text-danger"></span>
                </div>*@
                    @if (Model.Estado == 3 || Model.Estado == 4 || Model.Estado == 5)
                    {

                        <div class="col-md-6">
                            <label class="col-md-12 col-form-label texto-pregunta">Descripción Solución</label>
                            @if (Model.Estado == 5)
                            {
                                <textarea asp-for="DescripcionSolucion" name="DescripcionSolucion" class="form-control" readonly></textarea>
                            }
                            else
                            {
                                <textarea asp-for="DescripcionSolucion" name="DescripcionSolucion" class="form-control"></textarea>
                            }
                            <span asp-validation-for="DescripcionSolucion" class="text-danger"></span>
                        </div>

                    }
                </div>
                @if ((Model.Op == 1 || Model.Op == 2) && (Model.Estado == 4 || Model.Estado == 5))
                {
                    <div class="form-group row">
                        <div class="col-md-6">

                            Desea hacer una observación sobre el servicio recibido? &nbsp;&nbsp;
                            @if (Model.ComentarioSatisfaccion != null)
                            {
                                if (Model.ComentarioSatisfaccion.Length != 0)
                                {
                                    @if (Model.Estado == 5)
                                    {
                                        <input type="checkbox" name="nivelsino" id="nivelsino" checked disabled />
                                    }
                                    else
                                    {
                                        <input type="checkbox" name="nivelsino" id="nivelsino" checked />
                                    }
                                }
                                else
                                {
                                    @if (Model.Estado == 5)
                                    {
                                        <input type="checkbox" name="nivelsino" id="nivelsino" disabled />
                                    }
                                    else
                                    {
                                        <input type="checkbox" name="nivelsino" id="nivelsino" />
                                    }

                                }
                            }
                            else
                            {
                                @if (Model.Estado == 5)
                                {
                                    <input type="checkbox" name="nivelsino" id="nivelsino" disabled />
                                }
                                else
                                {
                                    <input type="checkbox" name="nivelsino" id="nivelsino" />
                                }
                            }

                        </div>
                    </div>
                    <div class="form-group row">

                        <div class="col-md-6" id="comentario">
                            <label class="col-md-12 col-form-label texto-pregunta">Nivel de Satisfacción</label>
                            @if (Model.Estado == 5)
                            {
                                <textarea asp-for="ComentarioSatisfaccion" name="ComentarioSatisfaccion" class="form-control" readonly></textarea>
                            }
                            else
                            {
                                <textarea asp-for="ComentarioSatisfaccion" name="ComentarioSatisfaccion" class="form-control"></textarea>
                            }
                            <span asp-validation-for="ComentarioSatisfaccion" class="text-danger"></span>
                        </div>
                        <div class="col-md-6">
                            <br />

                            <div onmouseout="CRateSelected()">
                                <span id="span1" onmouseout="CRateOut(1)" onmouseover="CRateOver(1)" onclick="CRateClick(1)" class="fa fa-star-o fa-2x"></span>
                                <span id="span2" onmouseout="CRateOut(2)" onmouseover="CRateOver(2)" onclick="CRateClick(2)" class="fa fa-star-o fa-2x"></span>
                                <span id="span3" onmouseout="CRateOut(3)" onmouseover="CRateOver(3)" onclick="CRateClick(3)" class="fa fa-star-o fa-2x"></span>
                                <span id="span4" onmouseout="CRateOut(4)" onmouseover="CRateOver(4)" onclick="CRateClick(4)" class="fa fa-star-o fa-2x"></span>
                                <span id="span5" onmouseout="CRateOut(5)" onmouseover="CRateOver(5)" onclick="CRateClick(5)" class="fa fa-star-o fa-2x"></span>
                            </div>
                            <input type="hidden" id="lblRating" asp-for="EstadoSatisfaccion" name="EstadoSatisfaccion" />
                        </div>
                    </div>

                }
            }

        </div>
        </div>


            <br />
            <div class="form-group justify-content-between" style="margin-bottom: 0px !important">
                @if (Model.Op != 1)
                {
                    <button type="submit" class="btn btn-success">Guardar</button>
                }
                @if (Model.Id == 0)
                {
                    <button type="submit" class="btn btn-success">Guardar</button>
                }
                <button type="submit" class="btn btn-default close-button" data-dismiss="modal">Cancelar</button>
                @if (Model.Estado == 4 || Model.Estado == 3)
                {
                    @if (Model.Op == 1)
                    {
                        <input type="hidden" asp-for="Fin" name="Fin" class="form-control" value="5">
                    }
                    else
                    {
                        <input type="hidden" asp-for="Fin" name="Fin" class="form-control" value="4">

                    }
                    @if (Model.Op == 1)
                    {
                        <button type="submit" class="btn btn-primary">Finalizar Soporte</button>
                    }
                }
                </div>
</form>


<div class="modal fade" id="form-add" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">New message</h5>
        
      </div>
      <div class="modal-body">
        
        <form id="create-form" >

   
            <div class="row">
                <div class="col-md-12">
                    <div class="form-group row">
                        <div class="col-md-6">
                            <label class="col-md-12 col-form-label texto-pregunta" >Nombre y Apellido</label>
                            <input  type="text" name="NombreApellido" id="NombreApellido" class=" form-control" />
                            <span  class="text-danger"></span>
                        </div>

                        <div class="col-md-6">
                            <label class="col-md-12 col-form-label texto-pregunta" >Cargo</label>
                            <input  type="text" name="Cargo"  id="Cargo" class=" form-control" />
                            <span  class="text-danger"></span>
                        </div>

                    </div>

                </div>
            </div>

            <div class="row">
                <div class="col-md-12">
                    <div class="form-group row">
                        <div class="col-md-12">
                            <label class="col-md-12 col-form-label texto-pregunta" >Perfil</label>
                            <textarea  name="Perfil" id="Perfil" class=" form-control" ></textarea>
                            <span class="text-danger"></span>
                        </div>



                    </div>

                </div>
            </div>
   
            <div class="row">
                <div class="col-md-12">
                    <div class="form-group row">
                        <div class="col-md-12">
                            <label class="col-md-12 col-form-label texto-pregunta" >Tema</label>
                            <textarea   name="Tema" id="Tema" class=" form-control" ></textarea>
                            <span  class="text-danger"></span>
                        </div>



                    </div>

                </div>
            </div>
            <br />
    
        </form>
      </div>
      <div class="modal-footer">
          <button type="button" class="btn btn-primary" id="btnAgregar">Agregar</button>
          <button type="button" class="btn btn-secondary" id="btnCerrar">Cerrar</button>
 
      </div>
    </div>
  </div>
</div>

<script type="text/javascript" language=javascript>

    // $('#viewAllPonente').load('/Soporte/Comunicacion/LoadAllPonente?idComunicacion=@Model.Id');
      
     $('input[type=file]').change(function(e) {
        $in = $(this);
        $in.next().html($in.val());
    });

    $.validator.unobtrusive.parse(document);
     $(function () {
        $('#create-form').disableAutoFill();
        $("#comentario").hide();
  
        $("#divPonente").hide();
        $("#divLogo").hide();
        $("#presencialP").hide();
        $("#presencial").hide();
        $("#virtual").hide();

        cambiaTipoSolicitud();
        $('body').on('selected','#Comunicaciones_TipoSolicitud', function()  {
             alert( this.value );
            cambiaTipoSolicitud();

        });
        $('body').on('change','#Comunicaciones_TipoSolicitud', function()  {
         //    alert( this.value );
            cambiaTipoSolicitud();

        });
      });    
    

    function cambiaTipoSolicitud() {
        
         var seleccionar = $("#Comunicaciones_TipoSolicitud option:selected").val();
                 $("#virtual").hide();
                 $("#presencial").hide();
                 $("#presencialP").hide();
                 $("#divPonente").hide();
                 $("#divLogo").hide();
                

        switch (seleccionar) {
            case "1" :
              $("#virtual").show();
              $("#divPonente").show();
               $("#divLogo").show();
             break;
              case "2":
                 $("#presencial").show();
                 $("#presencialP").show();
                 $("#divPonente").show();
                 $("#divLogo").show();
             break;
              case "3":
                 $("#presencialP").show();
             break;
              case "4":
                $("#divLogo").show();
             break;

}

    }

    function addFile() {
      var div = document.createElement("div");
      div.setAttribute("class", "row");
       div.setAttribute("style", "padding: 3px;");

       var divc1 = document.createElement("div");
      divc1.setAttribute("class", "col-md-1");

      var d = document.createElement("button");
      d.setAttribute("type", "button");
      d.setAttribute("onclick", "deteFile(this)");
      d.setAttribute ("value", "Eliminar");
      d.setAttribute("class", "btn btn-danger");
       d.setAttribute("style", "padding: 2px 5px 3px 5px;");
          
      
      var ii = document.createElement("i");
      ii.setAttribute("class", "fas fa-trash");
      d.appendChild(ii);

      divc1.appendChild(d);
      div.appendChild(divc1);

  var divc2 = document.createElement("div");
      divc2.setAttribute("class", "col-md-11");
      var f = document.createElement("input");
      f.setAttribute("type", "file");
      f.setAttribute("name", "File");
      f.setAttribute("size", "50");

      divc2.appendChild(f);
      div.appendChild(divc2);

     
      document.getElementById("_container").appendChild(div);
   
    }

    function deteFile(o) {
      while (o.tagName != "DIV") o = o.parentNode;
      o.parentNode.removeChild(o);
    }

    if ($('#nivelsino:checked').val() !== undefined) {
        $("#comentario").show();
    }
    else {
        $("#comentario").hide();
    }

    $("#btnAddPonente").click(function () {
         document.getElementById("idact").value = "";
            
        });

    $("#btnAgregar").click(function () {
         
          Agregar();
           
        });

    $("#btnCerrar").click(function () {
         
          $('#form-add').modal('hide');
           
        });

    $(function () {

        $('#form-add').on('hidden.bs.modal', function (e) { 
           $("body").addClass("modal-open") 
        });

        $('#nivelsino').change(function () {
            if (this.checked) {
                $("#comentario").show();
            } else {
                $("#comentario").hide();
            }

           
        });

        $(".datepicker").datepicker({
                                format: "dd-mm-yyyy",
            autoclose: true,
            todayBtn: true});
                            //$("#VigDesde").datepicker({ dateFormat: 'dd-mm-yy' });
                            //$("#VigHasta").datepicker({ dateFormat: 'dd-mm-yy' });

      });


      var num = 0;
      function Agregar() {

                                let idact = document.getElementById("idact").value;

                                if (idact.length != 0) {
                                    EliminaFila(idact);
                                }

                                let nombres = document.getElementById("NombreApellido").value;
                                let cargo = document.getElementById("Cargo").value;
                                let perfil = document.getElementById("Perfil").value;
                                let tema = document.getElementById("Tema").value;
                                let IdPonente = document.getElementById("Id").value;

                                if (nombres.length == 0) {
                                    alert("Ingrese el ponente.");
                                    return;
                                }
                                if (cargo.length == 0) {
                                    alert("Ingrese el cargo.");
                                    return;
                                }
                                
                                if (perfil.length == 0) {
                                    alert("Ingrese el perfil.");
                                    return;
                                }
                                if (tema.length == 0) {
                                    alert("Ingrese el tema.");
                                    return;
                                }

                                //agregamos tabla
                                let Tabla = document.getElementById("ponenteTable");
                                let TR = document.createElement("tr");
                                TR.setAttribute('id', num);
                                // let TDId = document.createElement("td");
                                let TDPonente = document.createElement("td");
                                let TDCargo = document.createElement("td");
                                let TDPerfil = document.createElement("td");
                                let TDTema = document.createElement("td");
                                let TDEliminar = document.createElement("td");
                                TDEliminar.className = "text-right";
                                //let TDTotal = document.createElement("td");
                                // TR.appendChild(TDId);
                                TR.appendChild(TDPonente);
                                TR.appendChild(TDCargo);
                                TR.appendChild(TDPerfil);
                                TR.appendChild(TDTema);
                                TR.appendChild(TDEliminar);
                                //TR.appendChild(TDTotal);
                                // TDId.innerHTML = num;
                                TDPonente.innerHTML = nombres;
                                TDCargo.innerHTML = cargo;
                                TDPerfil.innerHTML = perfil;
                                TDTema.innerHTML = tema;
                                TDEliminar.innerHTML = " <button type='button' class='btn btn-warning btn-xp' id='btnViewModel' onclick=\"ActualizaFila(" + num + ",\'" + nombres.toString() + "\',\'" + cargo.toString()+"\',\'"+perfil.replace(/(\r\n|\n|\r)/gm, " ")+"\',\'"+tema.replace(/(\r\n|\n|\r)/gm, " ")+"\')\" data-toggle='modal' data-target='#form-add'> <i class='fas fa-pencil-alt'></i> </button> <button type='button' onclick='EliminaFila("+num+")' class='btn btn-danger btn-xp'><i class='fas fa-trash-alt'></i></button>";
          
                                //TDTotal.innerHTML = parseFloat(Cantidad) * parseFloat(Precio);
                                Tabla.appendChild(TR);

                                //agregamos hiddens
                                let DivConceptos = document.getElementById("divPonente");
                                 let HiddenAux = document.createElement("input");
                                let HiddenIndex = document.createElement("input");
                                let HiddenPonente = document.createElement("input");
                                let HiddenCargo = document.createElement("input");
                                let HiddenPerfil = document.createElement("input");
                                let HiddenTema = document.createElement("input");
                                HiddenAux.name = "Comunicaciones.Ponentes[" + num + "].Aux";
                                HiddenAux.value = num;
                                HiddenAux.type = "hidden";
                                HiddenIndex.name = "Comunicaciones.Ponentes[" + num + "].IdAux";
                                HiddenIndex.value = num;
                                HiddenIndex.type = "hidden";
                                HiddenPonente.name = "Comunicaciones.Ponentes[" + num + "].NombreApellido";
                                HiddenPonente.value = nombres;
                                HiddenPonente.type = "hidden";
                               
                                HiddenCargo.name = "Comunicaciones.Ponentes[" + num + "].Cargo";
                                HiddenCargo.value = cargo;
                                HiddenCargo.type = "hidden";
                                HiddenPerfil.name = "Comunicaciones.Ponentes[" + num + "].Perfil";
                                HiddenPerfil.value = perfil;
                                HiddenPerfil.type = "hidden";
                                HiddenTema.name = "Comunicaciones.Ponentes[" + num + "].Tema";
                                HiddenTema.value = tema;
                                HiddenTema.type = "hidden";

                                DivConceptos.appendChild(HiddenAux);
                                DivConceptos.appendChild(HiddenIndex);
                                DivConceptos.appendChild(HiddenPonente);
                                DivConceptos.appendChild(HiddenCargo);
                                DivConceptos.appendChild(HiddenPerfil);
                                DivConceptos.appendChild(HiddenTema);

                                document.getElementById("NombreApellido").value = "";
                                document.getElementById("Cargo").value = "";
                                document.getElementById("Perfil").value = "";
                                document.getElementById("Tema").value = "";

                                num++;
        }

        
        function EliminaFila(id) {

            $("#" + id).remove();

            var GestionViewModel = {
                id: id
            };

            // $.ajax({
            //    type: "post",
            //    url:'@Url.Action("OnPostDelete", "Meta", new { area = "Planificacion" })',
            //     data: GestionViewModel,
            //    datatype: "json",
            //    cache: false,
            //    success: function (data) {
            //    /*  alert('Validooo');*/

            //    },
            //    error: function(xhr) {
            //       // alert('No Valid Data');
            //    }
            //});
        }


        function ActualizaFila(id, nombre, cargo,perfil, tema) {
         
            alert(id);
            document.getElementById("idact").value = id;

            document.getElementById("NombreApellido").value=nombre;
            document.getElementById("Cargo").value=cargo;
            document.getElementById("Perfil").value=perfil;
            document.getElementById("Tema").value=tema;
           
        }
</script>
